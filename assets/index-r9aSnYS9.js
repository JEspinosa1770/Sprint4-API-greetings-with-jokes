(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}})();let a=[];const k=3,h=()=>{const t=Math.floor(Math.random()*k);let e="";switch(t){case 0:e="https://icanhazdadjoke.com/";break;case 1:e="https://api.chucknorris.io/jokes/random";break;case 2:e="https://official-joke-api.appspot.com/jokes/random";break;default:throw new Error("Problemas con la fuente de chistes")}return[e,t.toString()]};function b(t,e,o){let n,r;switch(console.log(o),o){case 0:n=e.joke,r=e.id;break;case 1:n=e.value,r=e.id;break;case 2:n=e.setup+" -- "+e.punchline,r=e.id;break;default:throw new Error("Problemas con la fuente de chistes")}return{id:r,joke:n,status:t.status}}function p(t){document.querySelector(".joke").innerHTML=`
    <div>
      <h3>"${t}"</h3>
    </div>
  `}function m(t,e){const o=t.currentTarget,n=parseInt(o.getAttribute("data-value")||"0");return e.forEach(r=>{r.classList.remove("selected")}),o.classList.add("selected"),u(!1),n}function w(t){return a.findIndex(e=>e.joke==t)}function u(t){let e=document.getElementById("message__vote");t?e.textContent="Has votat":e.textContent=""}function v(t){let e="";const o=t.current_weather.weathercode;switch(!0){case o===0:e="cel clar";break;case o===1:e="algúns núvols";break;case o===2:e="uns quants núvols";break;case o===3:e="molts núvols";break;case(o>60&&o<70):e="pluja";break;default:e="temps indeterminat. Mira per la finestra.";break}const n=`Informació meteorològica: ${t.current_weather.temperature}° i hi ha ${e}`;document.getElementById("weather").textContent=n}async function g(t){const e=await fetch(t[0],{headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error HTTP: ${e.status}`);const o=await e.json(),n=b(e,o,parseInt(t[1]));return n.status=e.status,n}function y(t,e){try{if(t==="")throw new Error("Error en grabación de datos");const o=new Date().toISOString(),n={joke:t,score:e,date:o},r=w(t);r>=0?a[r].score=e:a.push(n),u(!0);const s=`${n.date} - S'ha votat l'acudit ${n.joke} amb una puntuació de ${n.score}. Contingut actual de l'array d'acudits: `;return console.clear(),console.log(s),console.log(a),!0}catch(o){return console.error("Hubo un problema: ",o),!1}}const E=async()=>{const e=await fetch("https://api.open-meteo.com/v1/forecast?latitude=41.3888&longitude=2.159&current_weather=true&language=es");if(!e.ok)throw new Error(`Error HTTP: ${e.status}`);const o=await e.json();return v(o),o},j=document.querySelector(".btn__next-joke"),_=document.querySelector(".btn__vote-joke");let c="";E();g(h()).then(t=>{p(t.joke),c=t.joke});j?.addEventListener("click",()=>{g(h()).then(t=>{p(t.joke),c=t.joke,u(!1)})});_?.addEventListener("click",t=>{t.preventDefault(),c.length>0?y(c,d):console.warn("No se puede votar. Esperando la carga del chiste.")});const l=document.querySelectorAll(".btn__select");let d=0,f=!0;if(f){const t=document.querySelector('.btn__select[data-value="2"]');t&&(d=m({currentTarget:t},l),f=!1)}l.forEach(t=>{t.addEventListener("click",e=>d=m(e,l))});
