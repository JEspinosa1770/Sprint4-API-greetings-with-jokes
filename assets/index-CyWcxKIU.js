(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&n(u)}).observe(document,{childList:!0,subtree:!0});function r(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(o){if(o.ep)return;o.ep=!0;const a=r(o);fetch(o.href,a)}})();let s=[];const h=3,d=()=>{const t=Math.floor(Math.random()*h),e=document.querySelector(".card__joke");let r="";switch(t){case 0:r="https://icanhazdadjoke.com/",e.style.backgroundImage='url("./images/emoji-carcajada.png")';break;case 1:r="https://api.chucknorris.io/jokes/random",e.style.backgroundImage='url("./images/chuck-norris.png")';break;case 2:r="https://official-joke-api.appspot.com/jokes/random",e.style.backgroundImage='url("./images/cartoon-man.png")';break;default:throw new Error("Problemas con la fuente de chistes")}return e.style.backgroundRepeat="no-repeat",e.style.backgroundSize="contain",[r,t.toString()]};function p(t,e,r){let n,o;switch(r){case 0:n=e.joke,o=e.id;break;case 1:n=e.value,o=e.id;break;case 2:n=e.setup+" -- "+e.punchline,o=e.id;break;default:throw new Error("Problemas con la fuente de chistes")}return{id:o,joke:n,status:t.status}}function f(t){document.querySelector(".joke").innerHTML=`
    <div>
      <h3>"${t}"</h3>
    </div>
  `}function m(t){t.forEach(e=>{e.classList.remove("selected")})}function k(t,e,r){const n=t.currentTarget;let o=parseInt(n.getAttribute("data-value")||"0");return m(e),r!=o?n.classList.add("selected"):o=0,o}function w(t){return s.findIndex(e=>e.joke==t)}function y(t){let e="";const r=t.current_weather.weathercode;switch(!0){case r===0:e='<img src="./images/weather-icons/day.svg" alt="Dia clar">';break;case(r>=1&&r<=3):e='<img src="./images/weather-icons/cloudy.svg" alt="Dia ennuvolat">';break;case(r>=51&&r<=67):e='<img src="./images/weather-icons/rainy-day.svg" alt="Dia pluj처s">';break;case(r>=71&&r<=77):e='<img src="./images/weather-icons/snowy-day.svg" alt="Dia amb neu">';break;case(r>=80&&r<=99):e='<img src="./images/weather-icons/thunder.svg" alt="Dia amb neu">';break;default:e="temps indeterminat. Mira per la finestra.";break}const n=`  ${t.current_weather.temperature}째`;document.getElementById("icons").innerHTML=e,document.getElementById("weather").innerHTML=n}async function g(t){const e=await fetch(t[0],{headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`Error HTTP: ${e.status}`);const r=await e.json(),n=p(e,r,parseInt(t[1]));return n.status=e.status,n}function b(t,e){if(e>0)try{if(t==="")throw new Error("Error en grabaci처n de datos");const r=new Date().toISOString(),n={joke:t,score:e,date:r},o=w(t);o>=0?s[o].score=e:s.push(n);const a=`${n.date} - S'ha votat l'acudit ${n.joke} amb una puntuaci처 de ${n.score}. Contingut actual de l'array d'acudits: `;return console.clear(),console.log(a),console.log(s),!0}catch(r){return console.error("Hubo un problema: ",r),!1}return!0}const v=async()=>{const e=await fetch("https://api.open-meteo.com/v1/forecast?latitude=41.3888&longitude=2.159&current_weather=true&language=es");if(!e.ok)throw new Error(`Error HTTP: ${e.status}`);const r=await e.json();return y(r),r},E=document.querySelector(".btn__next-joke"),l=document.querySelectorAll(".btn__select");let c="",i=0;v();g(d()).then(t=>{f(t.joke),c=t.joke});E?.addEventListener("click",()=>{c.length>0?(b(c,i),m(l),i=0):console.warn("No se puede votar. Esperando la carga del chiste."),g(d()).then(t=>{f(t.joke),c=t.joke})});l.forEach(t=>{t.addEventListener("click",e=>{i=k(e,l,i)})});
